关于重写与重构
本文来源www.datree.io的一篇blog，感觉挺不错的，就做了简单的翻译和整理，希望对大家有帮助。
#一.“代码一旦写入就会变成遗产”
作为软件开发人，都接触过遗留代码。可以说谁都不想触摸旧软件和陈年老代码。
抱怨永远不会解决问题，因为你写的代码已经成为遗产被其他人维护，不经意的一个喷嚏，很有可能被哪个家伙骂了。
每个开发人员都有过这样的经历，不得不在旧代码上维护和修复一个个错误，还要顺着错误的架构一直错下去，
最好的情况是，一个小业务模块，最坏的情况是它是你业务的核心。所以你今天必须作出选择，是维护，并进行重写，或者选择最好技术进行重构。对于每个公司，每个开发人员和每种产品，需要衡量金钱，时间和精力来抉择处最佳的方式。接下来就说一说它们的优缺点。
#二.重写和重构
##1重写：
重写会给你带来经验的好处 - 你知道旧系统的弱点，设计缺陷，当前需求和未来路线图。
您可以制定计划，设计一套能够克服未来挑战和计划的系统。缺点是当你编写新的系统并相信我时，你必须维护两个系统，
即使旧的系统可能处于“维护模式”，也会有这个重要的错误或重要的客户端请求，需要你去处理它。
不要忘记，一旦你将这个客户端请求实现到遗留系统中，它仍然需要被添加到新系统中。
##2.重构
重构将允许您用新的代码慢慢地替换系统中的旧代码。
拿一个函数，一个类或一个模块，然后在你的项目范围内重写它。所有的测试和集成都在那里，很容易验证你没有破坏任何东西，
确保功能保持不变。但是你不能用代码重构来创造奇迹，你不能选择不同的编程语言，而且大部分时间你甚至不能替换你的项目的核心框架。

 重构将更容易销售给您的产品经理。 您认为您的产品/市场/销售团队有更大的成功机会？：
“我们需要在产品核心部分冻结3个月的功能，而我们从头开始编写它，在这3个月后，所有内容都将保持一致，但在未来，我们将更容易维护和维护 扩展产品。“
要么 ...，“在未来4个月内，我们将努力提高该项目的稳定性和可维护性，从而对产品的这一部分的功能请求和错误修复进行缓慢推进”

#三.如何选择重写与重构
以下是一些指导原则，可帮助您选择何时重构以及何时进行完全重写。
##首先问自己这4个问题：
1.是否可以拆成多个模块？
如果您打算从整体架构转向微服务，或者无服务器或任何其他重要的产品架构转变，那么这是一次重写的好机会，从旧架构中取出的每一部分都可以从头开始编写。
2.基础技术能够长期支持您系统的需求吗？
多个线程的I / O密集型工作负载使用基于线程的语言的项目，无论您重构和优化多少，该语言都将成为您的玻璃天花板。你应该重写。
如果你有一个严格类型的系统，并且项目是用JavaScript编写的，你应该重写。
3.是否业务的核心吗？
如果这个遗留系统是你的产品的核心，并且你不能停止或失去速度。您的客户正在等待，您的竞争对手紧随其后。在这种情况下，您无法承受重写，并且需要逐步重构。
4.建立系统的人还在吗？
如果不是，则可能更容易重写，而不是挖掘不熟悉的代码，试图理解它并理解如何改进它。
#四.重写和重构结合
重写和重构结合。这是一种通过重写来替换旧代码部分，然后通过事件拦截来调用新组件而不是旧代码的方法。
可以降低风险。您逐渐更换旧系统的某些部分，您仍然可以使用E2E和集成测试，因为功能没有改变，调用代码仍旧在旧系统中。
另一个好处是，如果企业需要重写，您可以暂停或减慢重写，同时可以选择任意堆栈。

#五.结论
“我们是程序员。程序员在他们的心中是建筑师，他们到达一个网站时想要做的第一件事就是将这个地方压平并建造一些宏伟的东西。“ - Joel Spolsky代码重构
我非常赞同这种说法，每位开发人员在选择如何处理遗留代码时都会考虑到这一点，这一点很重要。重写总是看起来像是一个完美的选择，一个更好的机会，
以避免旧系统的所有错误。但是你必须考虑到你所处的情况，你有能力维护这两个系统吗？你能抽出时间吗？它会更好吗？有时代码重构是更安全和更实际的选择。
有时候进行代码重构可能会让您在可维护性和性能方面取得快速胜利，同时允许您从头开始投资构建产品的新部件。
微服务和无服务器体系结构可以缓解这些决策中的危险，允许重写较小的代码组件，这一过程花费较少的时间并影响较小的产品。

